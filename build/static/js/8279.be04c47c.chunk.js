"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[8279],{41931:function(e,n,t){t.d(n,{Z:function(){return b}});var a=t(4942),r=t(1413),s=t(42982),l=t(70885),i=t(47313),c=t(51474),o=t(26926),d=t(52654),u=t(54070),m=t(57864),f=t(91907),h=t(65188),x=t(77344),p=t(15103),g=t(46417);function b(e){var n=e.closeModalCaseChat,t=e.dataFields,b=e.departmentId,v=e.departmentName,j=(0,i.useState)(t||[]),y=(0,l.Z)(j,2),k=y[0],N=y[1],C=(0,h.eC)().showNotification,_=(0,i.useState)(!1),w=(0,l.Z)(_,2),S=w[0],Z=w[1],E=(0,x.m)().companyId,I=(0,p.tT)().isStaff;(0,i.useEffect)((function(){k.length||(console.log("yeeeee"),N([{dataName:"",isRequired:!1,id:(0,f.x0)()}]))}),[]),console.log("fields",k);var R=function(e,n){var t=e.target,l=t.value,i="checkbox"===t.type?t.checked:l,c=t.name,o=(0,s.Z)(k).map((function(e,t){return t===n?(0,r.Z)((0,r.Z)({},e),{},(0,a.Z)({},c,i)):e}));N(o)},T=(0,h.bK)({url:"/".concat(E,"/departments/").concat(b,"/"),values:{data_field:(null===k||void 0===k?void 0:k.length)&&(null===k||void 0===k?void 0:k.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{fieldName:e.dataName.toLowerCase().split(" ").join("_")})}))),is_staff:"true"===I,name:v},method:"patch",cb:{success:function(e,t){Z(!1),n()},error:function(e,n){var t,a;Z(!1),C({message:null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message,variant:"error"})}}}).fetchData;return(0,g.jsx)("div",{className:"w-[500px] px-5",children:S?(0,g.jsx)("div",{className:"flex justify-center mb-4",children:(0,g.jsx)(c.aN,{})}):(0,g.jsxs)("div",{children:[(0,g.jsx)("h4",{className:"mb-5 text-xl",children:"Department data fields"}),null!==k&&void 0!==k&&k.length?null===k||void 0===k?void 0:k.map((function(e,n){return(0,g.jsxs)("div",{className:"flex items-center mb-4",children:[(0,g.jsx)("div",{className:"flex-grow mr-5 ",children:(0,g.jsx)("input",{name:"dataName",value:e.fieldName,onChange:function(e){return R(e,n)},className:"border bg-kgrey-light-grey-1 border-transparent rounded-lg text-xs px-6 py-3.5 outline-none transition focus:border-primary focus:shadow-lg w-full placeholder-current placeholder-kgrey dark:bg-kdark-lighter dark:text-white hover:border-primary"})}),(0,g.jsx)(o.D8,{control:(0,g.jsx)(d.k,{checked:e.isRequired,onChange:function(e){return R(e,n)}}),label:"Required",name:"isRequired",classes:{label:"!text-xs font-light text-kgrey-welcome"}}),(0,g.jsx)(u.Z,{onClick:function(){return function(e){var n=(0,s.Z)(k),t=n.filter((function(t){return t.id!==e.id&&n.length>1}));N(t)}(e)},children:(0,g.jsx)(m.YK6,{color:"#979797",size:"18px"})})]},e.id)})):null,(0,g.jsx)("div",{className:"flex justify-end",children:(0,g.jsx)(c.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",color:"primary",onClick:function(){var e={dataName:"",isRequired:!1,id:(0,f.x0)()};N((function(n){return[].concat((0,s.Z)(n),[e])}))},children:"Additional data field"})}),(0,g.jsxs)("div",{className:"branch-form__footer px-6 pt-4 pb-9 flex justify-end",children:[(0,g.jsx)(c.Ik,{className:"text-kgrey border-kgrey border mr-5",color:"default",onClick:n,children:"Cancel"}),(0,g.jsx)(c.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"submit",onClick:T,color:"primary",children:"Save"})]})]})})}},79773:function(e,n,t){t.d(n,{Z:function(){return b}});var a=t(15861),r=t(70885),s=t(64687),l=t.n(s),i=t(47313),c=t(77344),o=t(95762),d=t(26926),u=t(51474),m=t(65188),f=t(3925),h=t(54070),x=t(57864),p=t(94024),g=t(46417);function b(e){var n=e.setFieldValue,t=e.setChooseIcon,s=e.closeModal,b=e.setIcon,v=(0,c.m)().companyId,j=(0,i.useState)(!1),y=(0,r.Z)(j,2),k=y[0],N=y[1],C=(0,m.h0)("iconPage"),_=C.page,w=C.handlePage,S=C.removePage,Z=(0,i.useState)(""),E=(0,r.Z)(Z,2),I=E[0],R=E[1],T=(0,p.Z)(I,500),q=(0,r.Z)(T,1)[0];(0,i.useEffect)((function(){return function(){return S()}}),[]);var F=(0,m.bK)({url:"",dynamicUrl:!0,method:"put",cb:{success:function(){var e=(0,a.Z)(l().mark((function e(a,r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n("icon",a),N(!1),b(a),t(!1);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),error:function(e,n){console.log(e)}}}),M=F.fetchData;return(0,g.jsxs)("div",{className:"w-[500px] px-3",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("h4",{children:"Choose from library"}),(0,g.jsx)(h.Z,{onClick:s,children:(0,g.jsx)(x.oHP,{color:"#979797",size:"18px"})})]}),(0,g.jsxs)("div",{className:"group-sidebar__search relative w-[460px] mb-5 mx-auto",children:[(0,g.jsx)("input",{type:"search",value:I,className:"group-sidebar__search-input w-full outline-none border-b border-kgrey-border-solid focus:border-primary transition pl-7 placeholder-[rgba(45, 45, 45, 0.3)] pt-2 pb-2 dark:bg-kdark",placeholder:"Search",onChange:function(e){return R(e.target.value)}}),(0,g.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-1",children:(0,g.jsx)("div",{className:"text-kgrey",children:(0,g.jsx)(f.lnn,{})})})]}),v&&!k?(0,g.jsx)(o.Z.All,{entity:"iconsDepartment",name:"iconsDepartment-".concat(v),url:"/".concat(v,"/icons/"),params:{limit:12,extra:{search:q},page:_},children:function(e){var n=e.items,t=e.isFetched,a=e.meta,r=n.map((function(e){return e}));return(0,g.jsx)(g.Fragment,{children:t?(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"mb-6 flex flex-wrap justify-around",children:r.map((function(e){var n=e.id,t=e.icon,a=e.name;return(0,g.jsxs)("div",{onClick:function(){return function(e){N(!0),M({url:"".concat(v,"/icons/").concat(e,"/documentize/")})}(n)},className:"flex flex-col items-center mx-2 px-2 py-2 rounded-md mb-4 w-24 cursor-pointer hover:shadow-md",children:[(0,g.jsx)("img",{className:"inline-block w-8 h-8 mb-3",src:t}),(0,g.jsx)("p",{className:"text-10px text-kgrey dark:text-white",children:a})]},n)}))}),(0,g.jsx)("div",{className:"news__pagination my-4",children:n.length?(0,g.jsx)(d.tl,{count:null===a||void 0===a?void 0:a.last_page,page:_?+_:1,defaultPage:6,siblingCount:1,color:"primary",onChange:w}):null})]}):(0,g.jsx)("div",{className:"flex justify-center mb-4",children:(0,g.jsx)(u.aN,{})})})}}):(0,g.jsx)("div",{className:"flex justify-center mb-4",children:(0,g.jsx)(u.aN,{})})]})}},8279:function(e,n,t){t.d(n,{Z:function(){return S}});var a=t(70885),r=t(47313),s=t(94715),l=t(17480),i=t(51474),c=t(26926),o=t(68323),d=t(54070),u=t(57864),m=t(85700),f=t(46225),h=t(77344),x=t(69706),p=t.n(x),g=t(32335),b=t(79773),v=t(15103),j=t(52654),y=t(65188),k=t(61818),N=t(41931),C=t(46417),_="".concat(g.Z.PUBLIC_ASSETS,"img"),w=[{label:"minutes",value:"MINUTES"},{label:"hours",value:"HOURS"},{label:"days",value:"DAYS"}];function S(e){var n=e.values,t=e.setFieldValue,x=e.setFieldError,g=e.isSubmitting,S=(e.errors,e.closeModal),Z=e.resetForm,E=e.isCreate,I=e.id,R=e.departmentId,T=e.formValuesSetter,q=void 0===T?function(){return null}:T,F=(0,h.m)().companyId,M=(0,y.h9)({assignRequired:!E&&(null===n||void 0===n?void 0:n.assign_required)}),P=M.checked,A=M.handleChange,D=(0,r.useState)(null!==n&&void 0!==n&&n.link?"link":"caseChat"),U=(0,a.Z)(D,2),H=U[0],O=U[1],V=(0,r.useState)(!1),Y=(0,a.Z)(V,2),B=Y[0],Q=Y[1],z=(0,r.useState)(!1),K=(0,a.Z)(z,2),L=K[0],$=K[1],G=(0,v.tT)(),J=G.isStaff,W=G.setIsStaff,X=(0,r.useState)("true"===J?"staff":"client"),ee=(0,a.Z)(X,2),ne=ee[0],te=ee[1],ae=function(){return $((function(e){return!e}))};(0,r.useEffect)((function(){t("is_staff","staff"===ne),W("staff"===ne?"true":"false")}),[ne]);var re=(0,r.useState)(null),se=(0,a.Z)(re,2),le=se[0],ie=se[1],ce=(0,r.useState)(!1),oe=(0,a.Z)(ce,2),de=oe[0],ue=oe[1],me=(0,r.useState)(E?null===n||void 0===n?void 0:n.icon:null),fe=(0,a.Z)(me,2),he=fe[0],xe=fe[1];(0,r.useEffect)((function(){he&&t("icon",he)}),[he]),(0,r.useEffect)((function(){"link"===H&&x("link","Required")}),[H]),(0,r.useEffect)((function(){I&&t("department",{id:I})}),[]),(0,r.useEffect)((function(){if(E){var e=["name","link","phone","case_escalation_time","initial_response_time"],t=Object.keys(n).filter((function(t){if((Array.isArray(n[t])?n[t].length:n[t])&&e.includes(t))return n[t]}));q(t)}}),[n]),(0,r.useEffect)((function(){t("assign_required",P.assignRequired)}),[P.assignRequired]);return(0,C.jsxs)("div",{id:"department-form",children:[(0,C.jsxs)("div",{className:"branch-form__header border-b border-kgrey-dark-1/30 px-6 py-4 -mt-5 flex-center-between",children:[(0,C.jsx)("div",{className:"branch-form__heading font-base font-medium",children:"".concat(E?"Create new":"Update"," department")}),E?(0,C.jsx)("div",{className:"branch-form__reset text-kgrey text-sm cursor-pointer hover:text-kdark transition",onClick:Z,children:"Clear"}):null]}),(0,C.jsxs)("div",{className:" w-100 p-6",children:[(0,C.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Icon"}),(0,C.jsxs)("div",{className:"flex items-center mb-5",children:[(0,C.jsxs)("div",{className:"user-avatar-box__display relative  w-20 h-20 rounded-full overflow-hidden flex-centered dark:bg-kdark",children:[(0,C.jsx)("img",{src:E?p()(he,"thumbnail")||"".concat(_,"/chat-placeholder.png"):p()(null===n||void 0===n?void 0:n.icon,"thumbnail")||"".concat(_,"/chat-placeholder.png"),alt:"",className:"object-fit"}),null!==le&&(0,C.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 w-10 h-10 z-10",children:[(0,C.jsx)("div",{className:"upload-media-spinner",children:(0,C.jsx)(i.aN,{variant:"determinate",value:le})}),(0,C.jsx)("div",{onClick:function(){ue(!0),ie(null)},className:"absolute w-8 h-8 z-20 top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 text-3xl text-primary-dark hover:text-primary transition cursor-pointer",children:(0,C.jsx)(u.SV5,{})})]})]}),(0,C.jsx)("div",{className:"ml-5",children:(0,C.jsx)(i.bA,{uploadMeta:le,setUploadMeta:ie,cancelSending:de,setCancelSending:ue,setFile:xe})})]}),(0,C.jsx)("div",{onClick:function(){Q(!0)},className:"cursor-pointer inline-block mb-4 rounded-tl-10 rounded-tr-10 rounded-br-10 border-dashed border p-3.5 bg-kgrey-bg dark:bg-primary-300 darl:text-white",children:"Choose from icon library"}),(0,C.jsx)(s.gN,{label:"Title",name:"name",component:l.Mg,placeholder:"Enter title"}),(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Function"}),(0,C.jsxs)(c.Ee,{value:H,onChange:function(e){var n=e.target.value;O(n),"caseChat"===n&&t("link",null)},"aria-label":"Function",className:"!flex-row font-base text-kgrey",children:[(0,C.jsx)(c.D8,{value:"caseChat",control:(0,C.jsx)(c.Y8,{color:"primary"}),label:"Case Chat"}),(0,C.jsx)(c.D8,{value:"link",control:(0,C.jsx)(c.Y8,{color:"primary"}),label:"Hyperlink"})]}),"link"===H?(0,C.jsx)(s.gN,{label:"Hyperlink",name:"link",component:l.Mg,placeholder:"Hyperlink"}):null]}),E?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Type"}),(0,C.jsxs)(c.Ee,{value:ne,onChange:function(e){te(e.target.value)},"aria-label":"Type",name:"is_staff",className:"!flex-row font-base text-kgrey",children:[(0,C.jsx)(c.D8,{value:"staff",control:(0,C.jsx)(c.Y8,{color:"primary"}),label:"Staff"}),(0,C.jsx)(c.D8,{value:"client",control:(0,C.jsx)(c.Y8,{color:"primary"}),label:"Client"})]})]}):null,(0,C.jsx)(s.gN,{label:"Phone number",name:"phone",component:l.UO,placeholder:"Enter company mobile phone number",enableSearch:!0,onChangeHandler:t}),(0,C.jsxs)("div",{className:"mb-3.5",children:[(0,C.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Initial required response time"}),(0,C.jsxs)("div",{className:"flex items-center mb-3.5",children:[(0,C.jsx)(o.ZP,{title:"By defining this time, the system will alert the admins of this department when managers do not respond to a staff escalation within the timeframe designated for a specific case, when the case is initially created",placement:"top",children:(0,C.jsx)(d.Z,{className:"p-0 mr-20",children:(0,C.jsx)(u.kA6,{})})}),(0,C.jsx)(s.gN,{name:"case_escalation_time",component:l.Mg,type:"number",placeholder:"time",classNames:"!mb-0",labelClasses:"hidden"}),(0,C.jsx)("div",{className:"flex-grow ml-4",children:(0,C.jsx)(s.gN,{className:"flex-1",component:l.mg,styles:m.gb,name:"case_escalation_time_unit",defaultValue:w[0],options:w,isSearchable:!f.tq})})]}),(0,C.jsxs)("div",{className:"flex items-center",children:[(0,C.jsx)(o.ZP,{title:"By defining this time, the system will alert the admins of this department when managers do not respond to a staff escalation within the timeframe designated for a specific case, when the case is initially created",placement:"top",children:(0,C.jsx)(d.Z,{className:"p-0 mr-20",children:(0,C.jsx)(u.kA6,{})})}),(0,C.jsx)(s.gN,{name:"initial_response_time",component:l.Mg,type:"number",placeholder:"time",classNames:"!mb-0",labelClasses:"hidden"}),(0,C.jsx)("div",{className:"flex-grow ml-4",children:(0,C.jsx)(s.gN,{component:l.mg,styles:m.gb,name:"initial_response_time_unit",defaultValue:w[0],options:w,isSearchable:!f.tq,className:"flex-1"})})]})]}),(0,C.jsx)("div",{className:"ml-1",children:(0,C.jsx)(c.D8,{control:(0,C.jsx)(j.k,{checked:P.assignRequired,onChange:A,name:"assignRequired"}),label:"Assign Required (available in edit mode)",className:"mb-4",disabled:E,classes:{label:"!text-xs font-light text-kgrey-welcome"}})}),P.assignRequired?(0,C.jsxs)("div",{className:"mb-3.5 react-select-dropdown",children:[(0,C.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Default assignees"}),(0,C.jsx)(s.gN,{component:k.Z,customStylesProps:m.gb,name:"default_assignees",placeholder:"Select default assignees",optionLabel:function(e){return"".concat(p()(e,"user.first_name","")," ").concat(p()(e,"user.last_name",""))},loadOptionsUrl:"/".concat(F,"/departments/").concat(R,"/users/"),loadOptionsParams:function(e){return{extra:{search:e}}},isSearchable:!0,maxMenuHeight:220,defaultValue:null===n||void 0===n?void 0:n.default_assignees,isClearable:!0,isMulti:!0,loadOptionsKey:"results",isCached:!0,onChange:function(e){}})]}):null]}),(0,C.jsxs)("div",{className:"branch-form__footer px-6 pt-4 pb-9 flex justify-between",children:[E?null:(0,C.jsx)(i.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"button",onClick:ae,color:"primary",children:"Case chat data field"}),(0,C.jsxs)("div",{children:[(0,C.jsx)(i.Ik,{className:"text-kgrey border-kgrey border mr-5",color:"default",onClick:S,children:"Cancel"}),(0,C.jsx)(i.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"submit",isSubmitting:g,color:"primary",children:E?"Create":"Update"})]})]}),(0,C.jsx)(c.Cx,{handleModalOpen:function(){return Q((function(e){return!e}))},open:Boolean(B),scrollable:!0,noPadding:!0,children:(0,C.jsx)(b.Z,{setIcon:xe,setFieldValue:t,setChooseIcon:Q,closeModal:function(){return Q(!1)}})}),E?null:(0,C.jsx)(c.Cx,{handleModalOpen:ae,open:Boolean(L),scrollable:!0,noPadding:!0,children:(0,C.jsx)(N.Z,{dataFields:null===n||void 0===n?void 0:n.data_field,departmentId:R,departmentName:null===n||void 0===n?void 0:n.name,closeModalCaseChat:function(){return $(!1)}})}),g?(0,C.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70",children:(0,C.jsx)(i.aN,{})}):null]})}S.defaultProps={isCreate:!0,department:null,resetForm:function(){}}},15103:function(e,n,t){t.d(n,{$i:function(){return o},tT:function(){return d}});var a=t(70885),r=t(1413),s=t(47313),l=t(46417),i=(0,s.createContext)(null),c=function(e,n){switch(n.type){case"SET_SEARCH_QUERY":return(0,r.Z)((0,r.Z)({},e),{},{searchQuery:n.payload});case"SET_IS_STAFF":return(0,r.Z)((0,r.Z)({},e),{},{isStaff:n.payload});default:return e}};function o(e){var n=e.children,t=(0,s.useReducer)(c,{searchQuery:"",isStaff:"true"}),r=(0,a.Z)(t,2),o=r[0],d=r[1],u=(0,s.useCallback)((function(e){d({type:"SET_SEARCH_QUERY",payload:e})}),[]),m=(0,s.useCallback)((function(e){d({type:"SET_IS_STAFF",payload:e})}),[]),f={searchQuery:o.searchQuery,isStaff:o.isStaff,setSearchQuery:u,setIsStaff:m};return(0,l.jsx)(i.Provider,{value:f,children:n})}var d=function(){var e=(0,s.useContext)(i);if(!e)throw new Error("useBusinessContext must be used within the BusinessContextProvider");return e}}}]);